syntax = "proto3";

option go_package = "nemon/nemon";

service Worker  {
  rpc GetApps(GetAppsRequest) returns (GetAppsResponse);
  rpc GetSysInfo(GetSysInfoRequest) returns (GetSysInfoResponse);
  rpc DeleteApp(DeleteAppsRequest) returns (DeleteAppsResponse);
  rpc IsEnrolled(IsEnrolledRequest) returns (IsEnrolledResponse);
  rpc SaveEnrollmentInfo(SaveEnrollmentInfoRequest) returns (SaveEnrollmentInfoResponse);
}

message IsEnrolledRequest {
  int64 key = 1;
}

message IsEnrolledResponse {
  bool enrolled = 1;  // check if is enrolled after above check
}

message SaveEnrollmentInfoRequest {
  bytes verifier = 1;
  bytes salt = 2;
  int64 SRPGroup = 3;
}

message SaveEnrollmentInfoResponse {}

message GetSysInfoRequest {
  int64 key = 1;
  string publicKeyN = 2;
  string publicKeyE = 3;
}

message GetSysInfoResponse {
  message SysInfo {
    bytes username = 1;
    bytes hostname = 2;
    bytes os = 3;
  }
  SysInfo workerSysInfo = 1;
  bytes AESKey = 2;
}

message GetAppsRequest  {}

message GetAppsResponse {
  message ApplicationInfo {
    bytes name = 1;
    bytes location = 2;
  }
  repeated ApplicationInfo applications = 1;
  bytes username = 2;
}

message DeleteAppsRequest {
  bytes name = 1;
  bytes location = 2;
}

message DeleteAppsResponse {
  bool ok = 1;
}